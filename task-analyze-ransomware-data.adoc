---
sidebar: sidebar
permalink: task-analyze-ransomware-data.html
keywords: personal data, personal information, sensitive, personal sensitive data, governance, data sense, ransomware, ransomware protection, cyberstorage, cyber attack, cybersecurity, permissions
summary: Use the Ransomware Protection dashboard to get a high-level overview of the cyber resilience of all your BlueXP working environments and additional data sources. You can drill down in each area to find more details and possible remediations.
---

= Managing cyber security recommendations for your data sources
:hardbreaks:
:nofooter:
:icons: font
:linkattrs:
:imagesdir: ./media/

[.lead]
Use the Ransomware Protection Dashboard to to get a high-level overview of the cyber resilience of all your BlueXP (formerly Cloud Manager) working environments and additional data sources. You can drill down in each area to find more details and possible remediations.

From the BlueXP left navigation menu, select *Protection > Ransomware protection*.

image:screenshot_ransomware_dashboard.png[A screenshot of the Ransomware Protection dashboard.]

== Ransomware Protection Score and Recommended Actions

The Ransomware Protection Score panel provides a simple way to see how resilient your data is to a ransomware attack. It is an aggregation of all the actions that are recommended to be taken in order to improve your data security posture and cyber resiliency. This panel works in conjunction with the Recommended Actions panel. There are two parts to the Ransomware Protection Score panel: 

* The overall protection score for your data (0-100% protected).
+
The score is based on a weighted calculation of all the possible recommendations.
* How many recommended actions are available to elevate your protection to 100% - if you implement the recommendations. 
+
The three types of recommended actions are in accordance with the https://www.ftc.gov/business-guidance/small-businesses/cybersecurity/nist-framework[NIST framework for cyber security^]: 

** Protect
** Detect
** Recover

image:screenshot_ransomware_protection_score1.png[A screenshot showing the Ransomware Protection Score panel and Recommended Actions panel.]

In this example page, there are seven recommended actions for the "Protect" category. The first recommendation is relevant for 258 files.

This panel supports working environments and data sources that have been added to Cloud Data Sense.

Note that recommendations are applicable per data source. So if the same recommendation is relevant to 3 data sources, it will be counted as 3 recommendations. 

You can click the image:button_down_caret.png[] to expand each Recommended Action, as shown below.

image:screenshot_ransomware_rec_actions_expanded.png[A screenshot showing the Recommended Actions panel expanded to show total actions per data source.]

To see the detailed list of data that has been identified as having a recommended action, click the *Investigate* button and you'll be redirected to the Cloud Data Sense Investigation page with the list of all the files that meet the criteria for the recommended action.

Then you can decide whether you want to apply the recommended action on all those files, or on just some of them.

After you fix the recommended action, the next refresh of the Ransomware Protection Score panel (every 5 minutes) will adjust the number for the score. You can also click the *Re-Scan* button to update the page now.

=== List of Recommended Actions

These are the currently tracked recommended actions and suggested solutions.

[cols=3*,options="header",cols="33,33,33",width="100%"]

|===
| Recommended Action
| Description
| Possible Solution

| Reduce permissions for X sensitive items with broad permissions
| Sensitive files that have open permissions have been found in your data sources by Cloud Data Sense. This includes all sensitive data (personal data and sensitive personal data) that have "open to organization" or "open to public" permissions.
| Click the *Investigate* button for each data source and you'll be redirected to the Data Sense Investigation page where you can view all the sensitive files at risk and take further action to reduce that risk. This includes how to reduce the broad permissions on those files.

| Move X sensitive items from Y unprotected data sources to safe locations
| Sensitive data has been found on unprotected data sources by Cloud Data Sense; these are locations where ransomware protection software is not able to protect the data. Typically, your IT organization has policies that restrict sensitive data from certain corporate locations. This recommended action allows you to identify the files that have sensitive data, and move them to a safer data source - where sensitive *IS* allowed to be stored.
| You can use Data Sense to quickly move these files to a better protected data source. You'll be using the Data Sense capability to https://docs.netapp.com/us-en/cloud-manager-data-sense/task-managing-highlights.html#moving-source-files-to-an-nfs-share[move source files to an NFS share^].

| Patch X open CVEs across Y data sources
| Unpatched CVEs (Common Vulnerabilities and Exposures) have been found on your on-premises ONTAP systems and/or Cloud Volumes ONTAP systems. These issues are identified only if the Digital Advisor product (formerly Active IQ Digital Advisor) is integrated with your storage systems. These are known vulnerabilities on NetApp storage systems that have fixes available to resolve the CVE. NetApp CVEs are listed on the https://security.netapp.com/advisory/[Product Security page^].
| Click the *Digital Advisor* button for each data sources and you'll be redirected to the _Security Vulnerabilities_ page in the Digital Advisor. There you can see the details about the open CVEs, and the recommended action to resolve each CVE. Often the resolution is to upgrade the ONTAP software on the system. https://docs.netapp.com/us-en/active-iq/task_increase_protection_against_hackers_and_Ransomware_attacks.html[Learn more about the Security Vulnerabilities page].

|===

== Cyber Resilience Map

The Cyber Resilience Map is the main area in the dashboard. It enables you to see all your working environments and data sources in a visual manner and be able to view relevant cyber-resilience information.

image:screenshot_ransomware_cyber_map.png[A screenshot of the Cyber Resilience Map on the Ransomware Protection dashboard.]

The map consists of three parts:

Left panel::
Shows a list of alerts for which the service is monitoring across all of your data sources. It also indicates the number of each particular alert that is active in your environment. Having a large number of one type of alert may be a good reason to try to resolve those alerts first.
Center panel::
Shows all of your data sources, services, and Active Directory in a graphical format. Healthy environments have a green indicator and environments that have alerts have a red indicator.
Right panel::
After you click on a data source that has a red indicator, this panel shows the alerts for that data source and provides recommendations to resolve the alert. Alerts are sorted so that the most recent alerts are listed first. Many recommendations lead you to another BlueXP service where you can resolve the issue.

These are the currently tracked alerts and suggested remediations.

[cols=3*,options="header",cols="33,33,33",width="100%"]

|===
| Alert
| Description
| Remediation

| High data encryption rates detected
| An abnormal increase in the percentage of encrypted files, or corrupted files, in the data source has occurred. This means that there was a greater than 20% increase in the percentage of encrypted files in the past 7 days. For example, if 50% of your files are encrypted, then a day later this number increases to 60%, you would see this alert.
| Click the link to launch the https://docs.netapp.com/us-en/cloud-manager-data-sense/task-controlling-private-data.html[Data Sense Investigation page^]. There you can select the filters for the specific _Working Environment_ and _Category (Encrypted and Corrupted)_ to view the list of all encrypted and corrupted files.

| Sensitive data with wide permissions found
| Sensitive data is found in files and the access permissions level is too high in a data source.
| Click the link to launch the https://docs.netapp.com/us-en/cloud-manager-data-sense/task-controlling-private-data.html[Data Sense Investigation page^]. There you can select the filters for the specific _Working Environment_, _Sensitivity Level (Sensitive Personal)_, and _Open Permissions_ to view the list of the files that have this issue.

| One or more volumes are not backed up using Cloud Backup
| Some volumes in the working environment aren't being protected using https://docs.netapp.com/us-en/cloud-manager-backup-restore/concept-backup-to-cloud.html[Cloud Backup^].
| Click the link to launch Cloud Backup and then you can identify the volumes that aren't being backed up in the working environment, and then decide if you want to enable backups on those volumes.

| One or more repositories (volumes, buckets, etc.) in your data sources are not being scanned by Data Sense
| Some data in your data sources isn't being scanned using https://docs.netapp.com/us-en/cloud-manager-data-sense/concept-cloud-compliance.html[Cloud Data Sense^] to identify compliance and privacy concerns and find optimization opportunities.
| Click the link to launch Data Sense and enable scanning and mapping for the items that are not being scanned.

| On-box anti-ransomware is not active for all volumes
| Some volumes in the on-prem ONTAP system don't have the https://docs.netapp.com/us-en/ontap/anti-ransomware/enable-task.html[NetApp anti-ransomware feature^] enabled.
| Click the link and you are redirected to the <<Status of ONTAP systems hardening,Harden your ONTAP environment panel>> and to the working environment with the issue. There you can investigate how best to fix the issue.

| ONTAP version is not updated
| The version of ONTAP software installed on your clusters are not in accordance with the recommendations from the https://www.netapp.com/pdf.html?item=/media/10674-tr4569.pdf[NetApp Security Hardening Guide for ONTAP Systems^].
| Click the link and you are redirected to the <<Status of ONTAP systems hardening,Harden your ONTAP environment panel>> and to the working environment with the issue. There you can investigate how best to fix the issue.

| Snapshots not configured for all volumes
| Some volumes in the working environment aren't being protected by creating volume snapshots.
| Click the link and you are redirected to the <<Status of ONTAP systems hardening,Harden your ONTAP environment panel>> and to the working environment with the issue. There you can investigate how best to fix the issue.

| File operations auditing is not turned on for all SVMs
| Some storage VMs in the working environment don't have file system auditing enabled. It is recommended so you can keep track of users actions on your files.
| Click the link and you are redirected to the <<Status of ONTAP systems hardening,Harden your ONTAP environment panel>> and to the working environment with the issue. There you can investigate whether you need to enable NAS auditing on your SVMs.

|===

== Top data repositories by data sensitivity

The _Top Data Repositories by Sensitivity Level_ panel lists up to the top four data repositories (working environments and data sources) that contain the most sensitive items. The bar chart for each working environment is divided into:

* Non-Sensitive data
* Personal data
* Sensitive Personal data

image:screenshot_ransomware_sensitivity.png[A screenshot of the data sensitivity chart on the Ransomware Protection dashboard.]

You can hover over each section to see the total number of items in each category.

Click each area to view the filtered results in the Data Sense Investigation page so that you can investigate further.

== Domain Administrator Group control

The _Domain Administrator Group control_ panel shows the most recent users who have been added into your domain administrator groups so that you can see if all the users should be allowed in those groups. You must have https://docs.netapp.com/us-en/cloud-manager-data-sense/task-add-active-directory-datasense.html[integrated a global Active Directory^] into Cloud Data Sense for this panel to be active.

image:screenshot_ransomware_domain_admin.png[A screenshot of the users who have been added as domain admins on the Ransomware Protection dashboard.]

The default administrative admin groups include “Administrators”, “Domain Admins”, “Enterprise Admins”, “Enterprise Key Admins”, and “Key Admins”.

== Data listed by types of open permissions

The _Open Permissions_ panel shows the percentage for each type of permission that exist for all files that are being scanned. The chart is provided from Data Sense and it shows the following types of permissions:

* No Open Access
* Open to Organization
* Open to Public
* Unknown Access

image:screenshot_ransomware_permissions.png[A screenshot of the encrypted file chart on the Ransomware Protection dashboard.]

You can hover over each section to see the percentage and total number of files in each category.

Click each area to view the filtered results in the Data Sense Investigation page so that you can investigate further.

== Data listed by encrypted files

The _Encrypted Files_ panel shows the top 4 data sources with the highest percentage of files that are encrypted, over time. These are typically items that have been password protected. It does this by comparing the encryption rates over the past 7 days to see which data sources have a greater than 20% increase. An increase of this amount could mean that ransomware is already attacked your system.

image:screenshot_ransomware_encrypt_files.png[A screenshot of the encrypted file chart on the Ransomware Protection dashboard.]

Click a line for one of the data sources to view the filtered results in the Data Sense Investigation page so that you can investigate further.

== Status of ONTAP systems hardening

The _Harden your ONTAP environment_ panel provides the status of certain settings in your ONTAP systems that track how secure your deployment is according to the https://www.netapp.com/pdf.html?item=/media/10674-tr4569.pdf[NetApp Security Hardening Guide for ONTAP Systems^] and to the https://docs.netapp.com/us-en/ontap/anti-ransomware/index.html[ONTAP anti-ransomware feature^] that proactively detects and warns about abnormal activity.

You can review the recommendations and then decide how you want to address the potential issues. You can follow the steps to change the settings on your clusters, defer the changes to another time, or ignore the suggestion.

This panel supports on-prem ONTAP, Cloud Volumes ONTAP, and Amazon FSx for NetApp ONTAP systems at this time.

image:screenshot_ransomware_harden_ontap.png[A screenshot of the status for ONTAP hardening on the Ransomware Protection dashboard.]

The settings that are being tracked include:

[cols=3*,options="header",cols="33,33,33",width="100%"]

|===
| Hardening Objective
| Description
| Remediation

| ONTAP Anti-ransomware
| The percentage of volumes that have on-box anti-ransomware activated. Valid for on-prem ONTAP systems only.
A green status icon indicates > 85% of volumes are enabled. Yellow indicates 40-85% are enabled. Red indicates < 40% are enabled.
| https://docs.netapp.com/us-en/ontap/anti-ransomware/enable-task.html#system-manager-procedure[See how to enable anti-ransomware on your volumes^] using System Manager.

| NAS Auditing
| The number of storage VMs that have file system auditing enabled.
A green status icon indicates > 85% of SVMs have NAS file system auditing enabled. Yellow indicates 40-85% are enabled. Red indicates < 40% are enabled.
| https://docs.netapp.com/us-en/ontap/nas-audit/auditing-events-concept.html[See how to enable NAS auditing on SVMs^] using the CLI.

| ONTAP Version
| The version of ONTAP software installed on your clusters.
A green status icon indicates that the version is current. A yellow icon indicates that the cluster is behind by 1 or 2 patch versions or 1 minor version for on-prem systems, or behind by 1 major version for Cloud Volumes ONTAP. A red icon indicates that the cluster is behind by 3 patch versions, or 2 minor versions, or 1 major version for on-prem systems, or behind by 2 major versions for Cloud Volumes ONTAP.
| https://docs.netapp.com/us-en/ontap/setup-upgrade/index.html[See the best way to upgrade your on-prem clusters^] or https://docs.netapp.com/us-en/cloud-manager-cloud-volumes-ontap/task-updating-ontap-cloud.html[your Cloud Volumes ONTAP systems^].

| Snapshots
| Is the snapshot capability activated on data volumes, and what percentage of volumes have Snapshot copies.
A green status icon indicates > 85% of volumes have snapshots enabled. Yellow indicates 40-85% are enabled. Red indicates < 40% are enabled.
| https://docs.netapp.com/us-en/ontap/task_dp_configure_snapshot.html[See how to enable volume snapshots on your on-prem clusters^], or https://docs.netapp.com/us-en/cloud-manager-cloud-volumes-ontap/task-manage-volumes.html#manage-volumes[on your Cloud Volumes ONTAP systems^], or https://docs.netapp.com/us-en/cloud-manager-fsx-ontap/use/task-manage-fsx-volumes.html#manage-snapshot-copies[on your FSx for ONTAP systems^].

|===
// , or https://docs.netapp.com/us-en/cloud-manager-azure-netapp-files/task-manage-volumes.html#manage-snapshot-copies[on your Azure NetApp Files systems^]
// For clusters that have low numbers for certain categories, you can click the System Manager button at the end of each row to correct the issue. You can also click the Cloud Backup button to activate backups for the volumes, or the Data Sense button to scan the volumes on the clusters to investigate compliance and governance conformance.

== Status of permissions on your critical business data

The _Business critical data permissions analysis_ panel shows the permissions status of data that is critical for your business. That way you can quickly assess how well you are protecting your business critical data.

image:screenshot_ransomware_critical_permissions.png[A screenshot of the permissions status for the data you are managing on the Ransomware Protection dashboard.]

Initially this panel shows data based on default policies that we have selected. But you can select the 2 most important Data Sense _Policies_ that you have created to view your most critical business data. See how to https://docs.netapp.com/us-en/cloud-manager-data-sense/task-org-private-data.html#creating-custom-policies[create your policies using Data Sense^].

The graph shows permission analysis of all the data that meets the criteria from your policies. It lists the number of items that are:

* Open to public permissions - the items which Data Sense considers as open to public
* Open to organization permissions - the items which Data Sense considers as open to organization
* No open permissions - the items which Data Sense considers as no open permissions
* Unknown permissions - the items which Data Sense considers as unknown permissions

Hover over each bar in the charts to view the number of results in each category. Click a bar and the Data Sense Investigation page is displayed so you can investigate further about which items have open permissions and whether you should make any adjustments to file permissions.

== Backup status of your critical business data

The _Backup Status_ panel shows how different categories of data are being protected using Cloud Backup. This identifies how comprehensively your most important categories of data are backed up in case you need to recover because of a ransomware attack. This data is a visual representation of how many items of a specific category in a working environment are backed up.

Only on-prem ONTAP and Cloud Volumes ONTAP working environments that are already being backed up using Cloud Backup _and_ scanned using Cloud Data Sense will appear in this panel.

image:screenshot_ransomware_backups.png[A screenshot of the backup status for the data you are managing on the Ransomware Protection dashboard.]

Initially this panel shows data based on default categories that we have selected. But you can select the categories of data that you want to track; for example, codes files, contracts, etc. See the full list of https://docs.netapp.com/us-en/cloud-manager-data-sense/reference-private-data-categories.html#types-of-categories[categories] that are available from Cloud Data Sense for your working environments. Then select up to 4 categories.

After the data is populated, hover over each square in the charts to view the number of files that are backed up out of all files in the same category in the working environment. A green square means 85% or greater of your files are being backed up. A yellow square means between 40% and 85% of your files are being backed up. And a red square means 40% or fewer files are being backed up.

You can click the *Cloud Backup* button at the end of the row to go to the Cloud Backup interface to enable backup on more volumes in each working environment.

== Storage system vulnerabilities

The _Storage system vulnerabilities_ panel shows the total number of high, medium, and low security vulnerabilities that the Active IQ Digital Advisor tool has found on each of your ONTAP clusters. High vulnerabilities should be looked at immediately to make sure your systems are not open for attack.

.Prerequisites

* The BlueXP Connector must be installed on your premises - not deployed with a cloud provider.
* You must have an on-premises ONTAP cluster
* The cluster is configured in Active IQ
* You must have registered an existing NSS account in BlueXP to view your clusters, and to view the Active IQ Digital Advisor UI.

Note that you can view the Active IQ Digital Advisor directly by selecting *Health > Digital advisor* from the BlueXP menu.

image:screenshot_ransomware_vulnerabilities.png[A screenshot that shows the number of security vulnerabilities in your ONTAP storage systems.]

Click the type of vulnerability (High, Medium, Low) you want to view for one of your clusters and you are redirected to the Security Vulnerabilities page in Active IQ Digital Advisor. (More about this page can be found in the https://docs.netapp.com/us-en/active-iq/task_increase_protection_against_hackers_and_Ransomware_attacks.html[Active IQ Digital Advisor documentation].) You can view the vulnerabilities and then follow the recommended action to resolve the issue. Oftentimes the resolution is to upgrade your ONTAP software with a point release, or full release, that resolves the vulnerability.

== Data in your volumes that are being protected using SnapLock

You can use NetApp SnapLock technology on your ONTAP volumes to retain files in unmodified form for regulatory and governance purposes. You can commit files and Snapshot copies to "write once, read many" (WORM) storage, and set retention periods for this WORM-protected data. https://docs.netapp.com/us-en/ontap/snaplock/snaplock-concept.html[Learn more about SnapLock].

The _Critical data immutability_ panel shows the number of items in your working environments that are being protected from modification and deletion on WORM storage by using ONTAP SnapLock technology. This allows you to view how much of your data has an immutable copy so you can better understand your backup and recovery plans against ransomware.

.Prerequisites

* The BlueXP Connector must be installed on your premises - not deployed with a cloud provider.
* You must have an on-premises ONTAP cluster
* You must have a *SnapLock* license installed on at least one node in the cluster

image:screenshot_ransomware_data_snaplocked.png[A screenshot of the Critical data immutability panel for your ONTAP storage systems.]

Initially this panel shows data based on default policies that we have selected. But you can select the 2 most important Data Sense _Policies_ that you have created to view your most critical business data. See how to https://docs.netapp.com/us-en/cloud-manager-data-sense/task-org-private-data.html#creating-custom-policies[create your policies using Data Sense^].

The panel shows the following information for the data that matches the selected policies:

* The number of business critical files in all of your scanned working environments that are configured to use SnapLock.
* The number of business critical files in all of your scanned working environments, excluding those that are configured for SnapLock. Note that some of these files could be protected using a mechanism other than SnapLock.

Data Sense policies that include the following filters are not available in the dropdown for selected policies because they rule out important search areas:

* Working environment name
* Working environment type
* Storage repository
* File path

So when creating the policies to view your critical business data in the _Critical data immutability_ panel, make sure you keep this in mind.

== Ransomware incidents detected on your systems

Ransomware incidents detected on your managed systems will appear as alerts in the _Ransomware incidents_ panel. This includes data corruption and encryption events. The panel will display the number of encrypted files identified in the suspect volume, the types of file extensions, and the time the attack occurred.
//add exfiltration or deletion at some point.

image:screenshot_ransomware_incidents.png[A screenshot of the Ransomware Incidents panel.]

Current support is for on-premises ONTAP clusters that are running Autonomous Ransomware Protection (ARP). ARP uses workload analysis in NAS (NFS and SMB) environments to proactively detect and warn about abnormal activity that might indicate a ransomware attack. https://docs.netapp.com/us-en/ontap/anti-ransomware/index.html[Learn more here^].

Then you can click the *Analyze* button to get recommendations for your next steps in resolving the issue.

//To analyze the incidents, you'll need to have installed and configured NetApp Cloud Secure. https://docs.netapp.com/us-en/cloudinsights/cs_intro.html[Learn more about Cloud Secure^]. 

.Prerequisites

* The BlueXP Connector must be installed on your premises - not deployed with a cloud provider.
* You must have an on-premises ONTAP cluster running ONTAP 9.10.1 or greater
* You must have a *MT_EK_MGMT* (Multi-Tenant Key Management) license (ONTAP 9.10) or *Anti_ransomware* license (ONTAP 9.11.1 +) installed on at least one node in the cluster
* NetApp ARP must have been enabled for an initial learning period (also known as “dry run”) for 30 days before being switching over to "active mode" so that it has enough time to assess workload characteristics and properly report suspected ransomware attacks.

